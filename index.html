<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NASCAR Live Feed</title>
</head>
<body>

<h2>Lap Number: <span id="lapNumber"></span></h2>

<table border="1">
  <thead>
    <tr>
      <th>Vehicle Number</th>
      <th>Owner</th>
    </tr>
  </thead>
  <tbody id="liveFeedData"></tbody>
</table>

<p>Last Updated: <span id="lastUpdate"></span></p>

<h2>Owner Points Table</h2>
<table border="1">
  <thead>
    <tr>
      <th>Owner</th>
      <th>Driver</th>
      <th>Points Earned This Race</th>
    </tr>
  </thead>
  <tbody id="ownerPointsTable"></tbody>
</table>

<p>Last Updated: <span id="lastUpdatePoints"></span></p>

  
<script>
  // Driver-Owner mapping
const ownerDriverMap = {
"Shane Van Gisbergen":"Bobby Grobe (#2)",
"Tyler Reddick":"Brian Rye (#1)",
"Kyle Larson":"Daniel Grobe",
"Joey Logano":"David Lee Grobe",
"Chase Elliott":"Susan Grobe",
"William Byron":"Travis Penny",
"Austin Cindric":"Tommy Rye",
"Alex Bowman":"Jeff Lindhorst",
  // Add more mappings as needed
};

  function fetchLiveFeed() {
    fetch('https://cf.nascar.com/live/feeds/live-feed.json')
      .then(response => response.json())
      .then(data => {
        const lapNumberElement = document.getElementById('lapNumber');
        const liveFeedData = document.getElementById('liveFeedData');
        const lastUpdateElement = document.getElementById('lastUpdate');
        
        if (data && data.lap_number && Array.isArray(data.vehicles)) {
          lapNumberElement.textContent = data.lap_number;
          lastUpdateElement.textContent = new Date().toLocaleTimeString();

          // Clear existing table rows
          liveFeedData.innerHTML = '';

// Populate table with vehicle numbers and owners
data.vehicles.forEach(vehicle => {
  const row = document.createElement('tr');
  const owner = ownerDriverMap[vehicle.driver.full_name] || "-";
  row.innerHTML = `<td>${vehicle.vehicle_number}</td><td>${owner}</td>`;
  liveFeedData.appendChild(row);
});

        } else {
          console.error('Invalid JSON structure or missing data.');
        }
      })
      .catch(error => console.error('Error fetching live feed:', error));
  }

  // Initial fetch
  fetchLiveFeed();

  // Set interval for auto-updating every 60 seconds
  setInterval(fetchLiveFeed, 60000);

function fetchPointsFeed() {
    fetch('https://cf.nascar.com/live/feeds/live-points-feed.json')  // Replace this URL with the actual live points feed
      .then(response => response.json())
      .then(data => {
        const ownerPointsTable = document.getElementById('ownerPointsTable');
        const lastUpdatePointsElement = document.getElementById('lastUpdatePoints');
        lastUpdatePointsElement.textContent = new Date().toLocaleTimeString();

        // Clear the table
        ownerPointsTable.innerHTML = '';

        data.vehicles.forEach(vehicle => {
          const driverName = vehicle.driver.full_name;
          const pointsEarned = vehicle.points_earned_this_race || 0;  // Handle if points are missing

          if (ownerDriverMapping[driverName]) {
            const owner = ownerDriverMapping[driverName];

            // Create a new row for the owner points table
            const row = document.createElement('tr');
            row.innerHTML = `<td>${owner}</td><td>${driverName}</td><td>${pointsEarned}</td>`;
            ownerPointsTable.appendChild(row);
          }
        });
      })
      .catch(error => console.error('Error fetching points feed:', error));
  }

  // Initial fetch
  fetchPointsFeed();

  // Set interval for auto-updating every 60 seconds
  setInterval(fetchPointsFeed, 60000);

</script>

</body>
</html>


